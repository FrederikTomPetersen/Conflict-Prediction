#Possible workspaces - adjust to your local preferences
DataCave = "C:/Users/Frederik/Documents/SpecialeData/"
Private = "C:/Users/Frederik/Documents/SpecialeScripts/"
GitHub = "C:/Users/Frederik/Documents/GitHub/Ethnic-Conflict-Prediction"
Models = "C:/Users/Frederik/Documents/SpecialeModels/"
Latexfigure ="C:/Users/Frederik/OneDrive - Københavns Universitet/Speciale paper/03_figures"
Latextable= "C:/Users/Frederik/OneDrive - Københavns Universitet/Speciale paper/04_tables"
# This scripts binds the dataanalysis of my thesis. It aims to control
# the workflow of the project. it starts out by loading all the necessary packages
# for the project. Then it defines alle the functions neccesary for the later scripts.
# After this intial defintions it starts getting the data from different sources.
# When the datasets are gathered it will automatically begin to tidy the data in order to make af join possible
# after the data are gathered
setwd(GitHub)
source("2 Packages.R")
source("3 Functions.R")
source("4 PostGres_connect.R")
CountryCodelistPanel <-  codelist_panel %>%
select(country.name.en,iso3c, p4n, fips) %>%
filter(!is.na(p4n), !is.na(iso3c), !is.na(fips))
CountryCodelistPanel <-  unique(CountryCodelistPanel)
CountryCodelistPanel <- CountryCodelistPanel
StatesBase <-  CountryCodelistPanel %>%
group_by(country.name.en, iso3c,p4n,fips) %>%
expand(year= 1989:2017, month = 1:12) # giver en tabel med 36936 country-months
rm(CountryCodelistPanel)
WDI_enrollment <- WDI(indicator ="SE.PRM.ENRR.MA", start=1989, end=2017,  country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(Dataset), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
test %>% na.locf(SE.PRM.ENRR.MA)
WDI_enrollment <- WDI(indicator ="SE.PRM.ENRR.MA", start=1989, end=2017,  country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
test %>% na.locf(test$SE.PRM.ENRR.MA)
View(test)
test %>% na.locf(test$SE.PRM.ENRR.MA) -> test2
View(test2)
tjek <- test %>%
group_by(isp2c) %>%
na.locf(test$SE.PRM.ENRR.MA)
tjek <- test %>%
group_by(iso2c) %>%
na.locf(test$SE.PRM.ENRR.MA)
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.PRM.ENRR.MA)
View(tjek)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
WDI_enrollment <- WDI(indicator ="SE.SCH.LIFE.MA", start=1989, end=2017,  country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.PRM.ENRR.MA)
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.SCH.LIFE.MA)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.SCH.LIFE.MA)
WDI_enrollment <- WDI(indicator ="SE.PRM.ENRR.MA", start=1989, end=2017,  country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.PRM.ENRR.MA)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
WDI_enrollment <-  WDI(indicator = "SE.SEC.ENRR.MF", start =1989, end =2017, country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
WDI_enrollment <-  WDI(indicator = "SE.SEC.ENRR.MF", start =1989, end =2017, country = 'all')
WDI_enrollment <-  WDI(indicator = "SE.SEC.ENRR.MF", start =1989, end =2017, country = 'all')
WDI_enrollment <-  WDI(indicator = "SE.SEC.ENRR.MF", start =1989, end =2017, country = 'all')
WDI_enrollment <-  WDI(indicator = "SE.SEC.ENRR", start =1989, end =2017, country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.SEC.ENRR)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
WDI_enrollment <-  WDI(indicator = "SE.SEC.ENRR.MA", start =1989, end =2017, country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.SEC.ENRR.MA)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
WDI_enrollment <-  WDI(indicator = "SE.PRM.ENRR", start =1989, end =2017, country = 'all')
test <- StatesBase %>%
left_join(WDI_enrollment, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.PRM.ENRR)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
list <- WDIsearch('GDP')
View(list)
list <- WDIsearch('GDP capita')
View(list)
list <- WDIsearch('GDP')
View(list)
WDI_ <- WDI(indicator ="NY.GDP.MKTP.CD", start=1989, end=2017,  country = 'all')
test <- StatesBase %>%
left_join(WDI_, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
Country <-  codelist_panel %>%
select(country.name.en,iso2c) %>%
distinct(country.name.en,iso2c) %>%
filter(!is.na(iso2c))
iso2clist <- Country$iso2c
WDI_ <- WDI(indicator ="NY.GDP.MKTP.CD", start=1989, end=2017,  country = 'all')%>%
filter(iso2c %in% iso2clist)
test <- StatesBase %>%
left_join(WDI_, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
test <- StatesBase %>%
left_join(WDI_, by = c("fips"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
View(test)
CountryCodelistPanel <-  codelist_panel
CountryCodelistPanel <-  codelist_panel %>%
select(country.name.en,iso3c, iso2c, p4n, fips) %>%
filter(!is.na(p4n), !is.na(iso3c), !is.na(fips), !is.na(iso2c))
CountryCodelistPanel <-  unique(CountryCodelistPanel)
CountryCodelistPanel <- CountryCodelistPanel
StatesBase <-  CountryCodelistPanel %>%
group_by(country.name.en, iso3c,p4n,fips,iso2c) %>%
expand(year= 1989:2017, month = 1:12) # giver en tabel med 36936 country-months
rm(CountryCodelistPanel)
WDI_ <- WDI(indicator ="NY.GDP.MKTP.CD", start=1989, end=2017,  country = 'all')%>%
filter(iso2c %in% iso2clist)
test <- StatesBase %>%
left_join(WDI_, by = c("iso2c"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$SE.PRM.ENRR)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
test <- StatesBase %>%
left_join(WDI_, by = c("iso2c"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$NY.GDP.MKTP.CD)
mice_plot <- aggr(tjek, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(tjek), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$NY.GDP.MKTP.CD)
WDI_ <- WDI(indicator ="NY.GDP.MKTPKD.KD.ZG", start=1989, end=2017,  country = 'all')%>%
filter(iso2c %in% iso2clist) # accepter obs loss
WDI_ <- WDI(indicator ="NY.GDP.MKTP.KD.ZG", start=1989, end=2017,  country = 'all')%>%
filter(iso2c %in% iso2clist) # accepter obs loss
test <- StatesBase %>%
left_join(WDI_, by = c("iso2c"="iso2c", "year" = "year"))
mice_plot <- aggr(test, col=c('navyblue','yellow'),
numbers=TRUE, sortVars=TRUE,
labels=names(test), cex.axis=.5,
gap=1, ylab=c("Missing data","Pattern"))
tjek <- test %>%
group_by(fips) %>%
na.locf(test$NY.GDP.MKTP.CD)
tjek <- test %>%
group_by(fips) %>%
na.locf(test$NY.GDP.MKTP.KD.ZG)
View(test)
tjek <- test %>%
group_by(fips) %>%
na.locf(test$NY.GDP.MKTP.KD.ZG, option = "nocb")
View(test)
