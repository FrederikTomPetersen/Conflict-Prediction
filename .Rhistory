# I states har jeg iso3c, gwcode
# I Gdelt har jeg fips
#Creating a base country year month structure
CountryCodelistPanel <-  codelist_panel %>%
select(country.name.en,iso3c, p4n, fips) %>%
filter(!is.na(p4n), !is.na(iso3c), !is.na(fips))
CountryCodelistPanel <-  unique(CountryCodelistPanel)
CountryCodelistPanel <- CountryCodelistPanel
StatesBase <-  CountryCodelistPanel %>%
group_by(country.name.en, iso3c,p4n,fips) %>%
expand(year= 2000:2017, month = 1:12) # giver en tabel med 36936 country-months
rm(CountryCodelistPanel)
# joining conflicts to dateset
DataSet <- StatesBase %>%
left_join(GedAggregated, by = c("p4n" = "country_id", "year" = "year", "month" = "month"))
rm(StatesBase,GedAggregated)
# joining gdelt to dataset
DataSet <-  DataSet %>%
left_join(GdeltGroup, by = c("fips"= "country", "year"="year", "month"="month"))
rm(GdeltGroup)
#Samling a WDI i en dataframe
DataSet<-  DataSet %>%
left_join(WDI, by = c("iso3c" ="isoalpha3", "year" = "year"))
rm(WDI)
#Data type fixer
DataSet$conflict_incidents <- as.numeric(DataSet$conflict_incidents)
#fixing the NA <- 0
DataSet <- DataSet %>% mutate(total_deaths_month = coalesce(total_deaths_month,0))
DataSet <- DataSet %>% mutate(nummentions = coalesce(nummentions,0))
DataSet <- DataSet %>% mutate(conflict_incidents = coalesce(conflict_incidents,0))
DataSet <- DataSet %>% mutate(total_deaths_year = coalesce(total_deaths_year,0))
DataSet <- DataSet %>% mutate(civilwar = coalesce(civilwar,0))
DataSet <- DataSet %>% mutate(civilwar_month = coalesce(civilwar_month,0))
DataSet <- DataSet %>% mutate(cw_month_contribute = coalesce(cw_month_contribute,0))
DataSet <- DataSet %>% mutate(deaths_running_months = coalesce(deaths_running_months,0))
DataSet <- DataSet %>% mutate(goldstein = coalesce(goldstein,0))
DataSet <- DataSet %>% mutate(avgtone = coalesce(avgtone,0))
DataSet <- DataSet %>% mutate(q1nm = coalesce(q1nm,0))
DataSet <- DataSet %>% mutate(q1gs = coalesce(q1gs,0))
DataSet <- DataSet %>% mutate(q1at = coalesce(q1at,0))
DataSet <- DataSet %>% mutate(q2nm = coalesce(q2nm,0))
DataSet <- DataSet %>% mutate(q2gs = coalesce(q2gs,0))
DataSet <- DataSet %>% mutate(q2at = coalesce(q2at,0))
DataSet <- DataSet %>% mutate(q3nm = coalesce(q3nm,0))
DataSet <- DataSet %>% mutate(q3gs = coalesce(q3gs,0))
DataSet <- DataSet %>% mutate(q3at = coalesce(q3at,0))
DataSet <- DataSet %>% mutate(q4nm = coalesce(q4nm,0))
DataSet <- DataSet %>% mutate(q4gs = coalesce(q4gs,0))
DataSet <- DataSet %>% mutate(q4at = coalesce(q4at,0))
DataSet <- DataSet %>% mutate(q1cnt = coalesce(q1cnt,0))
DataSet <- DataSet %>% mutate(q2cnt = coalesce(q2cnt,0))
DataSet <- DataSet %>% mutate(q3cnt = coalesce(q3cnt,0))
DataSet <- DataSet %>% mutate(q4cnt = coalesce(q4cnt,0))
DataSet <-  DataSet %>%
mutate(country = country.name.en)
NA2mean <- function(x){x <- x %>%
group_by(country,year) %>%
replace(x, is.na(x), mean(x, na.rm = TRUE))}
DataSet$gov_debt <- NA2mean(DataSet$gov_debt)
NA2mean <- function(x){x <- x %>%
group_by(country) %>%
replace(x, is.na(x), mean(x, na.rm = TRUE))}
DataSet$gov_debt <- NA2mean(DataSet$gov_debt)
list <-  df_index %>%
filter(total_deaths_month[which(year==2013 & month == 4)]>0) %>%
distinct(country)
View(list)
wdi_gdp_capita_2011c_country <- dbGetQuery(con, "SELECT * from wdi_gdp")
View(wdi_gdp_capita_2011c_country)
WDI <- dbGetQuery(con, "SELECT * from wdi")
rm(list)
rm(index)
rm(wdi_gdp_capita_2011c_country)
rm(complete)
rm(DataSet_test)
View(WDI)
WDI_GROUP <-  WDI %>%
group_by(country)
WDI_GROUP <-  WDI %>%
group_by(countryName) %>%
summarise(gov_debt[is.na(gov_debt),] = mean(gov_debt))
WDI_GROUP <-  WDI %>%
group_by(countryName) %>%
filter(is.na(gov_debt)
)
WDI_GROUP <-  WDI %>%
group_by(countryName) %>%
filter(is.na(gov_debt)) %>%
left_join(WDI)
View(WDI_GROUP)
WDI_GROUP_NOTNA <-  WDI %>%
group_by(countryName) %>%
filter(!is.na(gov_debt)) %>%
left_join(WDI)
WDI_GROUP_NOTNA <-  WDI %>%
group_by(countryName) %>%
filter(!is.na(gov_debt)) %>%
mutate(govdebtmean = mean(gov_debt))
View(WDI_GROUP_NOTNA)
WDI_Tester <-  WDI
WDI_Tester <-  WDI
WDI_Tester <- WDI_Tester %>%
left_join(WDI_GROUP_NOTNA)
View(WDI_Tester)
View(WDI_GROUP_NOTNA)
WDI_GROUP <-  WDI %>%
group_by(countryName) %>%
filter(is.na(gov_debt))
WDI_Tester <-  WDI
WDI_Tester <- WDI_Tester %>%
left_join(WDI_GROUP_NOTNA, by = c("countryName"="countryName"))
View(WDI_Tester)
WDI_GROUP_NOTNA <-  WDI %>%
group_by(countryName) %>%
filter(!is.na(gov_debt)) %>%
mutate(govdebtmean = mean(gov_debt)) %>%
distinct(countryName)
View(WDI_GROUP_NOTNA)
WDI_Tester <-  WDI
WDI_GROUP_NOTNA <-  WDI %>%
group_by(countryName) %>%
filter(!is.na(gov_debt)) %>%
mutate(govdebtmean = mean(gov_debt))
View(WDI_GROUP_NOTNA)
WDI_GROUP_NA <-  WDI %>%
group_by(countryName) %>%
distinct(countryName) %>%
left_join(WDI_GROUP_NOTNA)
View(WDI_GROUP_NA)
WDI_GROUP_NA <-  WDI %>%
group_by(countryName) %>%
distinct(countryName)
WDI_GROUP_NA_join <- WDI_GROUP_NA %>%
left_join(WDI_GROUP_NOTNA)
WDI_GROUP_NA_join <- WDI_GROUP_NA %>%
inner_join(WDI_GROUP_NOTNA)
WDI_GROUP_NA_join <- WDI_GROUP_NA %>%
rignt_join(WDI_GROUP_NOTNA)
WDI_GROUP_NA_join <- WDI_GROUP_NA %>%
right_join(WDI_GROUP_NOTNA)
WDI_GROUP_NA_join <- WDI_GROUP_NA %>%
left_join(WDI_GROUP_NOTNA) %>%
unique()
WDI_GROUP_NOTNA_selct <- WDI_GROUP_NOTNA %>%
select(countryName, govdebtmean)
WDI_GROUP_NOTNA_selct <- WDI_GROUP_NOTNA %>%
select(countryName, govdebtmean) %>%
distinct(countryName,govdebtmean)
View(WDI_GROUP_NOTNA_selct)
WDI_Tester <-  WDI_Tester %>%
left_join(WDI_GROUP_NOTNA_selct)
View(WDI_Tester)
WDI_Tester$gov_debt[is.na(WDI_Tester$gov_debt),] <- govdebtmean
WDI_Tester$gov_debt[is.na(WDI_Tester$gov_debt),] <- WDI_Tester$govdebtmean
View(WDI_Tester)
WDI_Tester2 <- WDI_Tester %>%
subset(is.na(gov_debt)) %>%
mutate(gov_debt = govdebtmean)
View(WDI_Tester2)
WDI_Tester$gov_debt[is.na(WDI_Tester$gov_debt)] <- WDI_Tester$govdebtmean
WDI_Tester2 <- WDI_Tester %>%
subset(is.na(gov_debt)) %>%
mutate(gov_debt[is.na(WDI_Tester$gov_debt)] = govdebtmean)
WDI_Tester <-  WDI
WDI_GROUP_NOTNA <-  WDI %>%
group_by(countryName) %>%
filter(!is.na(gov_debt)) %>%
mutate(govdebtmean = mean(gov_debt))
WDI_GROUP_NOTNA_selct <- WDI_GROUP_NOTNA %>%
select(countryName, govdebtmean) %>%
distinct(countryName,govdebtmean)
WDI_Tester <-  WDI_Tester %>%
left_join(WDI_GROUP_NOTNA_selct)
View(WDI_Tester)
rm(WDI_Tester2)
WDI_Tester <-  WDI_Tester %>%
mutate(gov_debt = ifelse(!is.na,gov_debt,govdebtmean))
WDI_Tester <-  WDI_Tester %>%
mutate(gov_debt = ifelse(is.na(gov_debt),gov_debt,govdebtmean))
View(WDI_Tester)
WDI_Tester <-  WDI
WDI_GROUP_NOTNA <-  WDI %>%
group_by(countryName) %>%
filter(!is.na(gov_debt)) %>%
mutate(govdebtmean = mean(gov_debt))
WDI_GROUP_NOTNA_selct <- WDI_GROUP_NOTNA %>%
select(countryName, govdebtmean) %>%
distinct(countryName,govdebtmean)
WDI_Tester <-  WDI_Tester %>%
left_join(WDI_GROUP_NOTNA_selct)
WDI_Tester <-  WDI_Tester %>%
mutate(gov_debt = ifelse(!is.na(gov_debt),gov_debt,govdebtmean))
View(WDI_Tester)
?paste0
Mean_On_Missing_WDI =function(x,y){
x <- x
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(paste0("mean_",y)=mean(y))
notnaselect <-  notna %>%
select(countryName, paste0("mean_",y)=mean(y)) %>%
distinct(countryName, paste0("mean_",y)=mean(y))
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, paste0("mean_",y))) %>%
select(-paste0("mean_",y))
return(x)
}
Mean_On_Missing_WDI =function(x,y){
x <- x
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(paste0("mean_",y)=mean(y))
notnaselect <-  notna %>%
select(countryName, paste0("mean_",y)=mean(y)) %>%
distinct(countryName, paste0("mean_",y)=mean(y))
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, paste0("mean_",y))) %>%
select(-paste0("mean_",y))
return(x)
}
cat("\014")
Mean_On_Missing_WDI =function(x,y){
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(paste0("mean_",y)=mean(y))
notnaselect <-  notna %>%
select(countryName, paste0("mean_",y)=mean(y)) %>%
distinct(countryName, paste0("mean_",y)=mean(y))
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, paste0("mean_",y))) %>%
select(-paste0("mean_",y))
return(x)
}
Mean_On_Missing_WDI =function(x,y){
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(paste0("mean_",y)=mean(x$y))
notnaselect <-  notna %>%
select(countryName, paste0("mean_",y)=mean(y)) %>%
distinct(countryName, paste0("mean_",y)=mean(y))
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, paste0("mean_",y))) %>%
select(-paste0("mean_",y))
return(x)
}
Mean_On_Missing_WDI =function(x,y){
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(paste0("mean_",y) = mean(x$y))
notnaselect <-  notna %>%
select(countryName, paste0("mean_",y)=mean(y)) %>%
distinct(countryName, paste0("mean_",y)=mean(y))
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, paste0("mean_",y))) %>%
select(-paste0("mean_",y))
return(x)
}
z <- paste0("mean_y",y)
Mean_On_Missing_WDI =function(x,y){
z <- paste0("mean_y",y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(z = mean(x$y))
notnaselect <-  notna %>%
select(countryName, z) %>%
distinct(countryName, z)
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, z)) %>%
select(-z)
return(x)
}
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester,gov_expenditure)
Mean_On_Missing_WDI =function(x,y){
z <- paste0("mean_y", x$y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(z = mean(x$y))
notnaselect <-  notna %>%
select(countryName, z) %>%
distinct(countryName, z)
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, z)) %>%
select(-z)
return(x)
}
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester, gov_expenditure)
Mean_On_Missing_WDI =function(x,y){
z <- paste0("mean_y", y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(z = mean(x$y))
notnaselect <-  notna %>%
select(countryName, z) %>%
distinct(countryName, z)
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, z)) %>%
select(-z)
return(x)
}
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester, "gov_expenditure")
x <-  WDI
y <-  gov_expenditure
y <-  "gov_expenditure"
z <- paste0("mean_y", y)
z <- paste0("mean_", y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(z = mean(x$y))
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester, WDI_Tester$gov_expenditure)
y <-  WDI_Tester$gov_expenditure
z <- paste0("mean_", y)
Mean_On_Missing_WDI =function(x,y){
z <- paste0("mean_y",y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(z = mean(x$y))
notnaselect <-  notna %>%
select(countryName, z) %>%
distinct(countryName, z)
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, z)) %>%
select(-z)
return(x)
}
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester,"gov_expenditure")
Mean_On_Missing_WDI =function(x,y){
z <- paste0("mean_y",y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(x$y)) %>%
mutate(z = mean(x$y))
notnaselect <-  notna %>%
select(countryName, z) %>%
distinct(countryName, z)
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, z)) %>%
select(-z)
return(x)
}
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester,"gov_expenditure")
Mean_On_Missing_WDI =function(x,y){
z <- paste0("mean_",y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(z)) %>%
mutate(z = mean(z))
notnaselect <-  notna %>%
select(countryName, z) %>%
distinct(countryName, z)
x <- x %>%
left_join(notnaselect)
x <- x %>%
mutate(y = ifelse(!is.na(y), y, z)) %>%
select(-z)
return(x)
}
WDI_Tester <- Mean_On_Missing_WDI(WDI_Tester,"gov_expenditure")
View(WDI_Tester)
x <- WDI_Tester
y <- "gov_expenditure"
z <- paste0("mean_",y)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(z = mean(y))
View(notna)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(pate0("mean_",y) = mean(y))
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(paste0("mean_",y) = mean(y))
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(paste(y) = mean(y))
z <- paste0("mean_",y)
x <- x
x[z] <-  NA
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(x$z = mean(y))
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(z = mean(y))
?.dots
?`$`
x <- WDI_Tester
y <- "gov_expenditure"
z <- paste0("mean_",y)
x[z] <-  NA
x <- WDI_Tester
WDI_Tester <-  WDI
x <- WDI_Tester
y <- "gov_expenditure"
z <- paste0("mean_",y)
x[z] <-  NA
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(z = mean(y))
notna[,z] <- mean(nota[,y])
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y))
notna[,z] <- mean(notna[,y])
View(notna)
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y))
notna[,z] <- mean(notna[,y])
notna[z] <- mean(notna[y])
notna[,z] <- mean(notna[,y])
mutate(`$`(x[,z]) = mean(`$`(x[,y])))
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(`$`(x[,z]) = mean(`$`(x[,y])))
notna <- x %>%
group_by(countryName) %>%
filter(!is.na(y)) %>%
mutate(notna[,z] = mean(notna[,y]))
?WDI
WDIsearch('agiculture')
WDIsearch('enrollment')
WDIsearch('agriculture')
WDIsearch('rural')
WDIsearch('cultivate')
WDIsearch('Coverage')
WDIsearch('farmland')
WDIsearch('land')
WDI_arable_land <-  WDI(indicator ="AG.LND.ARBL.ZS", start = 2000, end = 2018, extra =T, country='all'
)
View(WDI_arable_land)
WDIsearch('oil')
WDIsearch('diamonds')
WDIsearch('diamond')
WDIsearch('export')
WDIsearch('export')
WDIsearch('export')
WDIsearch('export merchandise')
WDIsearch('merchandise')
#####################################
# Fuels, minerals, and metals                #
#####################################
WDIsearch('Merchandise exports')
install.packages("psData")
library(psData)
library("psData")
library("psData")
install.packages("psData")
library("psData")
install.packages("rJava")
library("psData")
library(rJava)
devtools::install_github('psData', 'christophergandrud')
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre7')
library(rJava)
Sys.setenv(JAVA_HOME='C:\\Program Files\\Java\\jre1.8.0_144')
library(rJava)
install.packages("rJava")
library(rJava)
